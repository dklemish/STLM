b <- 0.5
eps <- 1e-3
R <- 10
nSpatial <- 3 # mass value, x, h
nLoc <- nrow(X)
mult <- 10
# Storage for Levy mass "jumps"
mass.pts <- matrix(0, nrow=mult*nLoc, ncol=nSpatial)
num.added <- rep(0, nLoc)
total.mass.pts <- 0
# Draw mass points for first location
levy.draws <- drawGamma(10, a, b, eps)
num.draws <- sum(levy.draws > 0)
draw.loc <- X[1] + runif(num.draws, -R, R)
draw.height <- runif(num.draws, 0, (R - abs(draw.loc - X[1])) / R^2)
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 1] <- levy.draws[1:num.draws]
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 2] <- draw.loc
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 3] <- draw.height
# plot(-9:1, (0:10)*0.01, type="l", xlim=c(-9,11))
# lines(1:11, (0:10)*-0.01 + 0.1)
# lines(draw.loc, draw.height, col="red", type="p")
num.added[1] <- num.draws
total.mass.pts <- total.mass.pts + num.draws
for(i in 2:nLoc){
# Draw mass points for other locations, but discard points that fall
# in the regions of previous locations
levy.draws <- drawGamma(10, a, b, eps)
num.draws  <- sum(levy.draws > 0)
draw.loc    <- X[i] + runif(num.draws, -R, R)
draw.height <- runif(num.draws, 0, (R - abs(draw.loc - X[i])) / R^2)
valid.new.pt <- rep(TRUE, num.draws)
# Check previous locations whether new mass positions fall in those location's shapes
for(j in 1:(i-1)){
valid.new.pt <- valid.new.pt &
(abs(X[j] - draw.loc) < R) &
(draw.height < (R-abs(draw.loc - X[j]))/R^2)
}
num.new <- sum(valid.new.pt)
num.added[i] <- num.new
if(num.new > 0){
mass.pts[(total.mass.pts+1):(total.mass.pts+num.new), 1] <- levy.draws[1:num.draws][valid.new.pt]
mass.pts[(total.mass.pts+1):(total.mass.pts+num.new), 2] <- draw.loc[valid.new.pt]
mass.pts[(total.mass.pts+1):(total.mass.pts+num.new), 3] <- draw.height[valid.new.pt]
total.mass.pts <- total.mass.pts + num.new
}
}
mass.pts <- mass.pts[1:total.mass.pts, ]
Y <- rep(0, nLoc)
mass.pts
nLoc
X
X <- matrix(1:100, ncol=1)
a <- 2
b <- 0.5
eps <- 1e-3
R <- 10
nSpatial <- 3 # mass value, x, h
nLoc <- nrow(X)
mult <- 10
# Storage for Levy mass "jumps"
mass.pts <- matrix(0, nrow=mult*nLoc, ncol=nSpatial)
num.added <- rep(0, nLoc)
total.mass.pts <- 0
# Draw mass points for first location
levy.draws <- drawGamma(10, a, b, eps)
num.draws <- sum(levy.draws > 0)
draw.loc <- X[1] + runif(num.draws, -R, R)
draw.height <- runif(num.draws, 0, (R - abs(draw.loc - X[1])) / R^2)
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 1] <- levy.draws[1:num.draws]
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 2] <- draw.loc
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 3] <- draw.height
# plot(-9:1, (0:10)*0.01, type="l", xlim=c(-9,11))
# lines(1:11, (0:10)*-0.01 + 0.1)
# lines(draw.loc, draw.height, col="red", type="p")
num.added[1] <- num.draws
total.mass.pts <- total.mass.pts + num.draws
for(i in 2:nLoc){
# Draw mass points for other locations, but discard points that fall
# in the regions of previous locations
levy.draws <- drawGamma(10, a, b, eps)
num.draws  <- sum(levy.draws > 0)
draw.loc    <- X[i,1] + runif(num.draws, -R, R)
draw.height <- runif(num.draws, 0, (R - abs(draw.loc - X[i,1])) / R^2)
valid.new.pt <- rep(TRUE, num.draws)
# Check previous locations whether new mass positions fall in those location's shapes
for(j in 1:(i-1)){
valid.new.pt <- valid.new.pt &
(abs(X[j,1] - draw.loc) < R) &
(draw.height < (R-abs(draw.loc - X[j,1]))/R^2)
}
num.new <- sum(valid.new.pt)
num.added[i] <- num.new
if(num.new > 0){
mass.pts[(total.mass.pts+1):(total.mass.pts+num.new), 1] <- levy.draws[1:num.draws][valid.new.pt]
mass.pts[(total.mass.pts+1):(total.mass.pts+num.new), 2] <- draw.loc[valid.new.pt]
mass.pts[(total.mass.pts+1):(total.mass.pts+num.new), 3] <- draw.height[valid.new.pt]
total.mass.pts <- total.mass.pts + num.new
}
}
mass.pts <- mass.pts[1:total.mass.pts, ]
# Calculate value of response at each location
Y <- rep(0, nLoc)
mass.pts
X <- matrix(1:100, ncol=1)
a <- 2
b <- 0.5
eps <- 1e-3
R <- 10
nSpatial <- 3 # mass value, x, h
nLoc <- nrow(X)
mult <- 10
# Storage for Levy mass "jumps"
mass.pts <- matrix(0, nrow=mult*nLoc, ncol=nSpatial)
num.added <- rep(0, nLoc)
total.mass.pts <- 0
# Draw mass points for first location
levy.draws <- drawGamma(10, a, b, eps)
num.draws <- sum(levy.draws > 0)
draw.loc <- X[1] + runif(num.draws, -R, R)
draw.height <- runif(num.draws, 0, (R - abs(draw.loc - X[1])) / R^2)
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 1] <- levy.draws[1:num.draws]
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 2] <- draw.loc
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 3] <- draw.height
# plot(-9:1, (0:10)*0.01, type="l", xlim=c(-9,11))
# lines(1:11, (0:10)*-0.01 + 0.1)
# lines(draw.loc, draw.height, col="red", type="p")
num.added[1] <- num.draws
total.mass.pts <- total.mass.pts + num.draws
i <- 2
levy.draws <- drawGamma(10, a, b, eps)
num.draws  <- sum(levy.draws > 0)
X[i,1] + runif(num.draws, -R, R)
X[i,1]
draw.loc    <- X[i,1] + runif(num.draws, -R, R)
draw.loc
draw.height <- runif(num.draws, 0, (R - abs(draw.loc - X[i,1])) / R^2)
valid.new.pt <- rep(TRUE, num.draws)
(abs(X[j,1] - draw.loc) < R)
j <- 1
(abs(X[j,1] - draw.loc) < R)
(draw.height < (R-abs(draw.loc - X[j,1]))/R^2)
for(j in 1:(i-1)){
valid.new.pt <- valid.new.pt &
(abs(X[j,1] - draw.loc) < R) &
(draw.height < (R-abs(draw.loc - X[j,1]))/R^2)
}
valid.new.pt
num.new <- sum(valid.new.pt)
num.added[i] <- num.new
draw.loc[valid.new.pt]
draw.loc
X <- matrix(1:100, ncol=1)
a <- 2
b <- 0.5
eps <- 1e-3
R <- 10
nSpatial <- 3 # mass value, x, h
nLoc <- nrow(X)
mult <- 10
# Storage for Levy mass "jumps"
mass.pts <- matrix(0, nrow=mult*nLoc, ncol=nSpatial)
num.added <- rep(0, nLoc)
total.mass.pts <- 0
# Draw mass points for first location
levy.draws <- drawGamma(10, a, b, eps)
num.draws <- sum(levy.draws > 0)
draw.loc <- X[1] + runif(num.draws, -R, R)
draw.height <- runif(num.draws, 0, (R - abs(draw.loc - X[1])) / R^2)
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 1] <- levy.draws[1:num.draws]
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 2] <- draw.loc
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 3] <- draw.height
# plot(-9:1, (0:10)*0.01, type="l", xlim=c(-9,11))
# lines(1:11, (0:10)*-0.01 + 0.1)
# lines(draw.loc, draw.height, col="red", type="p")
num.added[1] <- num.draws
total.mass.pts <- total.mass.pts + num.draws
for(i in 2:(nLoc-1)){
# Draw mass points for other locations, but discard points that fall
# in the regions of previous locations
levy.draws <- drawGamma(10, a, b, eps)
num.draws  <- sum(levy.draws > 0)
draw.loc    <- X[i,1] + runif(num.draws, -R, R)
draw.height <- runif(num.draws, 0, (R - abs(draw.loc - X[i,1])) / R^2)
valid.new.pt <- rep(TRUE, num.draws)
# Check previous locations whether new mass positions fall in those location's shapes
for(j in 1:(i-1)){
valid.new.pt <- valid.new.pt &
(abs(X[j,1] - draw.loc) < R) &
(draw.height < (R-abs(draw.loc - X[j,1]))/R^2)
}
num.new <- sum(valid.new.pt)
num.added[i] <- num.new
if(num.new > 0){
mass.pts[(total.mass.pts+1):(total.mass.pts+num.new), 1] <- levy.draws[1:num.draws][valid.new.pt]
mass.pts[(total.mass.pts+1):(total.mass.pts+num.new), 2] <- draw.loc[valid.new.pt]
mass.pts[(total.mass.pts+1):(total.mass.pts+num.new), 3] <- draw.height[valid.new.pt]
total.mass.pts <- total.mass.pts + num.new
}
}
mass.pts[1:100,]
i
i < - i+1
i <- i+1
levy.draws <- drawGamma(10, a, b, eps)
num.draws  <- sum(levy.draws > 0)
X[i,1]
X[i,1] + runif(num.draws, -R, R)
draw.loc    <- X[i,1] + runif(num.draws, -R, R)
draw.height <- runif(num.draws, 0, (R - abs(draw.loc - X[i,1])) / R^2)
drwa.loc
draw.loc
draw.height
valid.new.pt <- rep(TRUE, num.draws)
j <- 1
X[j,1]
abs(X[j,1] - draw.loc)
abs(X[j,1] - draw.loc) < R
X <- matrix(1:100, ncol=1)
a <- 2
b <- 0.5
eps <- 1e-3
R <- 10
nSpatial <- 3 # mass value, x, h
nLoc <- nrow(X)
mult <- 10
# Storage for Levy mass "jumps"
mass.pts <- matrix(0, nrow=mult*nLoc, ncol=nSpatial)
num.added <- rep(0, nLoc)
total.mass.pts <- 0
# Draw mass points for first location
levy.draws <- drawGamma(10, a, b, eps)
num.draws <- sum(levy.draws > 0)
draw.loc <- X[1] + runif(num.draws, -R, R)
draw.height <- runif(num.draws, 0, (R - abs(draw.loc - X[1])) / R^2)
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 1] <- levy.draws[1:num.draws]
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 2] <- draw.loc
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 3] <- draw.height
# plot(-9:1, (0:10)*0.01, type="l", xlim=c(-9,11))
# lines(1:11, (0:10)*-0.01 + 0.1)
# lines(draw.loc, draw.height, col="red", type="p")
num.added[1] <- num.draws
total.mass.pts <- total.mass.pts + num.draws
for(i in 2:nLoc){
# Draw mass points for other locations, but discard points that fall
# in the regions of previous locations
levy.draws <- drawGamma(10, a, b, eps)
num.draws  <- sum(levy.draws > 0)
draw.loc    <- X[i,1] + runif(num.draws, -R, R)
draw.height <- runif(num.draws, 0, (R - abs(draw.loc - X[i,1])) / R^2)
valid.new.pt <- rep(TRUE, num.draws)
# Check previous locations whether new mass positions fall in those location's shapes
for(j in 1:(i-1)){
valid.new.pt <- valid.new.pt &
(abs(X[j,1] - draw.loc) > R) &
(draw.height > (R-abs(draw.loc - X[j,1]))/R^2)
}
num.new <- sum(valid.new.pt)
num.added[i] <- num.new
if(num.new > 0){
mass.pts[(total.mass.pts+1):(total.mass.pts+num.new), 1] <- levy.draws[1:num.draws][valid.new.pt]
mass.pts[(total.mass.pts+1):(total.mass.pts+num.new), 2] <- draw.loc[valid.new.pt]
mass.pts[(total.mass.pts+1):(total.mass.pts+num.new), 3] <- draw.height[valid.new.pt]
total.mass.pts <- total.mass.pts + num.new
}
}
mass.pts <- mass.pts[1:total.mass.pts, ]
# Calculate value of response at each location
Y <- rep(0, nLoc)
mass.pts
for(i in 1:nLoc){
Y[i] <- sum(mass.pts[(abs(mass.pts[,2]-X[i,1]) < R) &
(mass.pts[,3] < (R-abs(mass.pts[,2] - X[i,1]))/R^2),
1])
}
Y
plot(X, Y)
library(STLM)
drawGammaRF_R(X, 2, 0.5, 1e-3)
drawGammaRF_R(X, 2, 0.5, 1e-3, 10)
plot(X, drawGammaRF_R(X, 2, 0.5, 1e-3, 10))
plot(X, drawGammaRF_R(X, 2, 0.5, 1e-3, 10))
plot(X, drawGammaRF_R(X, 2, 0.5, 1e-3, 10))
plot(X, drawGammaRF_R(X, 2, 0.5, 1e-3, 10))
plot(X, drawGammaRF_R(X, 2, 0.5, 1e-3, 10))
plot(X, drawGammaRF_R(X, 2, 0.5, 1e-3, 10))
plot(X, drawGammaRF_R(X, 2, 0.5, 1e-3, 10))
plot(X, drawGammaRF_R(X, 2, 0.5, 1e-3, 10))
plot(X, drawGammaRF_R(X, 2, 0.5, 1e-3, 10))
test <- matrix(0, nrow=2500, ncol=200)
for(i in 1:2500){
test[i,] <- drawGammaRF_R(X, 2, 0.5, 5e-4, 10, sd=i)
}
plot(X, test[1,])
test[1,]
X
test[1,]
X
test <- matrix(0, nrow=2500, ncol=100)
for(i in 1:2500){
test[i,] <- drawGammaRF_R(X, 2, 0.5, 5e-4, 10, sd=i)
}
plot(X, test[1,])
plot(X, test[2,])
plot(X, test[3,])
plot(X, test[4,])
plot(X, test[100,])
plot(X, test[1000,])
plot(X, test[2000,])
plot(X, test[2100,])
cor(test[,1], test[,2])
cor(test[,2], test[,3])
cyl.corr(1, 10, 1)
cone.corr(1, 10, 1)
cor(test[,3], test[,4])
cor(test[,4], test[,5])
cor(test[,5], test[,6])
cor(test[,6], test[,7])
cor(test[,99], test[,100])
cor(test[,98], test[,99])
test <- matrix(0, nrow=10000, ncol=100)
for(i in 1:10000){
test[i,] <- drawGammaRF_R(X, 2, 0.5, 5e-4, 10, sd=i)
}
plot(X, test[i,])
plot(X, test[1,])
plot(X, test[2,])
cor(test[,1], test[,2])
cor(test[,2], test[,3])
cor(test[,3], test[,4])
cor(test[,4], test[,5])
X <- matrix(seq(1, 20, by=0.25), ncol=1)
X <- matrix(seq(0, 20, by=0.25), ncol=1)
X <- matrix(seq(0, 20, by=0.25), ncol=1)
test <- matrix(0, nrow=20000, ncol=81)
for(i in 1:20000){
test[i,] <- drawGammaRF_R(X, 2, 0.5, 5e-4, 10, sd=i)
}
save.image("~/ConeTest.RData")
plot(X, test[1,])
plot(X, test[2,])
plot(X, test[3,])
plot(X, test[4,])
plot(X, test[5,])
plot(X, test[6,])
plot(X, test[7,])
hist(test[,10], freq=FALSE, breaks=50)
lines(seq(0.1,20, by=0.1), dgamma(seq(0.1,20, by=0.1), 2, 0.5), col="red")
hist(test[,40], freq=FALSE, breaks=50)
lines(seq(0.1,20, by=0.1), dgamma(seq(0.1,20, by=0.1), 2, 0.5), col="red")
hist(test[,80], freq=FALSE, breaks=50)
lines(seq(0.1,20, by=0.1), dgamma(seq(0.1,20, by=0.1), 2, 0.5), col="red")
hist(test[,81], freq=FALSE, breaks=50)
lines(seq(0.1,20, by=0.1), dgamma(seq(0.1,20, by=0.1), 2, 0.5), col="red")
hist(test[,1], freq=FALSE, breaks=50)
lines(seq(0.1,20, by=0.1), dgamma(seq(0.1,20, by=0.1), 2, 0.5), col="red")
hist(test[,5], freq=FALSE, breaks=50)
lines(seq(0.1,20, by=0.1), dgamma(seq(0.1,20, by=0.1), 2, 0.5), col="red")
hist(test[,5], freq=FALSE, breaks=200)
lines(seq(0.1,20, by=0.1), dgamma(seq(0.1,20, by=0.1), 2, 0.5), col="red")
hist(test[,1], freq=FALSE, breaks=200)
lines(seq(0.1,20, by=0.1), dgamma(seq(0.1,20, by=0.1), 2, 0.5), col="red")
hist(test[,75], freq=FALSE, breaks=200)
lines(seq(0.1,20, by=0.1), dgamma(seq(0.1,20, by=0.1), 2, 0.5), col="red")
cone.corr.test <- matrix(0, nrow=81, ncol=81)
for(i in 1:81){
for(j in 0:(81-i)){
cone.corr.test[i,j] <- cor(test[,i], test[, i+j])
}
}
test.cone <- melt(cone.corr.test)
test.cone
test.cone <- test.cone %>% filter(value != 0)
test.cone
test.cone$X <- test.cone$Var2 * 0.5
test.cone$X <- test.cone$Var2 * 0.25
head(test.cone)
ggplot(data=test.cone, aes(x=X, y=value)) +
geom_point(alpha=0.1) +
geom_line(data=data.frame(x=X, y=cone.corr(X, 10, 1)),aes(x=x,y=y), col="red") +
lims(x=c(0, 25)) +
theme_bw()
X <- matrix(seq(0, 20, by=0.25), ncol=1)
test <- matrix(0, nrow=20000, ncol=81)
for(i in 1:20000){
test[i,] <- drawGammaRF_R(X, 2, 0.5, 5e-4, 5, sd=i)
}
cone.corr.test <- matrix(0, nrow=81, ncol=81)
for(i in 1:81){
for(j in 0:(81-i)){
cone.corr.test[i,j] <- cor(test[,i], test[, i+j])
}
}
test.cone <- melt(cone.corr.test)
test.cone <- test.cone %>% filter(value != 0)
test.cone$X <- test.cone$Var2 * 0.25
ggplot(data=test.cone, aes(x=X, y=value)) +
geom_point(alpha=0.1) +
geom_line(data=data.frame(x=X, y=cone.corr(X, 10, 1)),aes(x=x,y=y), col="red") +
lims(x=c(0, 25)) +
theme_bw()
ggplot(data=test.cone, aes(x=X, y=value)) +
geom_point(alpha=0.1) +
geom_line(data=data.frame(x=X, y=cone.corr(X, 5, 1)),aes(x=x,y=y), col="red") +
lims(x=c(0, 25)) +
theme_bw()
ggplot(data=test.cone, aes(x=X, y=value)) +
geom_point(alpha=0.1) +
geom_line(data=data.frame(x=X, y=cone.corr(X, 5, 1)),aes(x=x,y=y), col="red") +
geom_line(data=data.frame(x=X, y=cyl.corr(X, 5, 1)),aes(x=x,y=y), col="blue") +
lims(x=c(0, 25)) +
theme_bw()
ggplot(data=test.cone, aes(x=X, y=value)) +
geom_point(alpha=0.1) +
geom_line(data=data.frame(x=X, y=cone.corr(X, 5, 1)),aes(x=x,y=y), col="red") +
geom_line(data=data.frame(x=X, y=cyl.corr(X, 5, 1)),aes(x=x,y=y), col="yellow") +
lims(x=c(0, 25)) +
theme_bw()
X <- 1:2
a <- 2
b <- 0.5
eps <- 1e-3
R <- 1
X <- matrix(1:2, ncol=1)
nSpatial <- 3 # mass value, x, h
nLoc <- nrow(X)
mult <- 100
mass.pts <- matrix(0, nrow=mult*nLoc, ncol=nSpatial)
num.added <- rep(0, nLoc)
total.mass.pts <- 0
levy.draws <- drawGamma(10, a, b, eps)
num.draws <- sum(levy.draws > 0)
levy.draws
sum(levy.draws)
qgamma(13.14, 2, 0.5)
pgamma(13.14, 2, 0.5)
draw.loc <- X[1] + runif(num.draws, -R, R)
draw.height <- runif(num.draws, 0, (R - abs(draw.loc - X[1])) / R^2)
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 1] <- levy.draws[1:num.draws]
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 2] <- draw.loc
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 3] <- draw.height
mass.pts[1:26,]
plot(mass.pts[,2], mass.pts[,3])
a <- 10
mass.pts <- matrix(0, nrow=mult*nLoc, ncol=nSpatial)
num.added <- rep(0, nLoc)
total.mass.pts <- 0
# Draw mass points for first location
levy.draws <- drawGamma(10, a, b, eps)
num.draws <- sum(levy.draws > 0)
draw.loc <- X[1] + runif(num.draws, -R, R)
draw.height <- runif(num.draws, 0, (R - abs(draw.loc - X[1])) / R^2)
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 1] <- levy.draws[1:num.draws]
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 2] <- draw.loc
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 3] <- draw.height
plot(mass.pts[,2], mass.pts[,3])
a <- 100
b <- 0.1
mass.pts <- matrix(0, nrow=mult*nLoc, ncol=nSpatial)
num.added <- rep(0, nLoc)
total.mass.pts <- 0
# Draw mass points for first location
levy.draws <- drawGamma(10, a, b, eps)
num.draws <- sum(levy.draws > 0)
draw.loc <- X[1] + runif(num.draws, -R, R)
draw.height <- runif(num.draws, 0, (R - abs(draw.loc - X[1])) / R^2)
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 1] <- levy.draws[1:num.draws]
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 2] <- draw.loc
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 3] <- draw.height
mult <- 1000
# Storage for Levy mass "jumps"
mass.pts <- matrix(0, nrow=mult*nLoc, ncol=nSpatial)
num.added <- rep(0, nLoc)
total.mass.pts <- 0
# Draw mass points for first location
levy.draws <- drawGamma(10, a, b, eps)
num.draws <- sum(levy.draws > 0)
draw.loc <- X[1] + runif(num.draws, -R, R)
draw.height <- runif(num.draws, 0, (R - abs(draw.loc - X[1])) / R^2)
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 1] <- levy.draws[1:num.draws]
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 2] <- draw.loc
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 3] <- draw.height
plot(mass.pts[,2], mass.pts[,3])
a <- 2000
nLoc <- nrow(X)
mult <- 10000
# Storage for Levy mass "jumps"
mass.pts <- matrix(0, nrow=mult*nLoc, ncol=nSpatial)
num.added <- rep(0, nLoc)
total.mass.pts <- 0
# Draw mass points for first location
levy.draws <- drawGamma(10, a, b, eps)
num.draws <- sum(levy.draws > 0)
draw.loc <- X[1] + runif(num.draws, -R, R)
draw.height <- runif(num.draws, 0, (R - abs(draw.loc - X[1])) / R^2)
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 1] <- levy.draws[1:num.draws]
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 2] <- draw.loc
mass.pts[(total.mass.pts+1):(total.mass.pts+num.draws), 3] <- draw.height
plot(mass.pts[,2], mass.pts[,3])
data.frame(mass.pts[,2:3]
)
head(data.frame(mass.pts[,2:3])
)
ggplot(data=data.frame(mass.pts[,2:3]), aes(x=X1, y=X2)) +
geom_point(alpha=0.3) + theme_bw()
ggplot(data=data.frame(mass.pts[,2:3]), aes(x=X1, y=X2)) +
geom_point(alpha=0.1) + theme_bw()
ggplot(data=data.frame(mass.pts[,2:3]), aes(x=X1, y=X2)) +
geom_point(alpha=0.01) + theme_bw()
ggplot(data=data.frame(mass.pts[,2:3]), aes(x=X1, y=X2)) +
geom_point(alpha=0.05) + theme_bw()
ggplot(data=data.frame(mass.pts[,2:3]), aes(x=X1, y=X2)) +
geom_point(alpha=0.005) + theme_bw()
